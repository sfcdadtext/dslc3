<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>対話システムライブコンペティション２</title>
<meta name="Description" content="対話システムライブコンペティション２のページです" />
<meta name="Keywords" content="対話システムライブコンペティション,対話システムライブコンペ,ライブコンペ,対話システム,対話,雑談" />
<link rel="icon" href="http://saetl.net/favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" type="img/x-icon" href="http://saetl.net/favicon.ico" />
<link rel="stylesheet" href="css/style.css">
<link href='https://fonts.googleapis.com/css?family=Berkshire+Swash|Lobster' rel='stylesheet' type='text/css'><!--googlewebフォント-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"><!--アイコンwebフォント-->
<link rel="stylesheet" href="css/vertical-responsive-menu.css" /><!--レスポンシブメニュー-->
<link rel="stylesheet" href="css/twilight.css"><!--スライドショー-->
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
<![endif]-->
<link rel="stylesheet" href="css/prettify.css" type="text/css">
</head>

<body onload="prettyPrint()">
<noscript>
<p>※このページはJavaScriptを使用しています。JavaScript設定を有効にしてご覧ください。</p>
</noscript>

<!--ヘッダー-->
<header class="header clearfix">
  <button type="button" id="toggleMenu" class="toggle_menu"> <i class="fa fa-bars"></i> </button>

  <!--ロゴ（ページ左上のサイト名）-->
  <h1><a href="index.html" title="対話システムライブコンペティション２">対話システムライブコンペティション２</a></h1>

</header>

<!--ナビゲーションメニューー-->
<nav class="vertical_nav">
  <ul id="js-menu" class="menu">
    <li class="menu--item"> <a href="index.html" class="menu--link" title="Home"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">Home</span> </a> </li>
    <li class="menu--item"> <a href="opentrack.html" class="menu--link" title="Open"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">オープントラック</span> </a> </li>
    <li class="menu--item"> <a href="situationtrack.html" class="menu--link" title="Situation"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">シチュエーショントラック</span> </a> </li>
    <li class="menu--item"> <a href="gettingstart.html" class="menu--link" title="Getting Started"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">Getting Started</span> </a> </li>
    <li class="menu--item"> <a href="lecture.html" class="menu--link" title="Lecture"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">講習会</span> </a> </li>
    <li class="menu--item"> <a href="inquiry.html" class="menu--link" title="Inquiry"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">お問い合わせ</span> </a> </li>
    <!-- <li class="menu--item"> <a href="result.html" class="menu--link" title="LiveComp"> <i class="menu--icon  fa fa-fw fa-info-circle"></i> <span class="menu--label">当日の発表（UPDATED!）</span> </a> </li> -->

  </ul>
  <button id="collapse_menu" class="collapse_menu"> <i class="collapse_menu--icon  fa fa-fw"></i> <span class="collapse_menu--label">Recolher menu</span> </button>

  <!--ページ左下の表示-->
  <p class="copyright">Copyright &copy; 2020 <br/>
    DIALOGUE SYSTEM  <br/>
    LIVE COMPETITION  <br/>
    All Rights Reserved.</p>
</nav>

<div class="wrapper">
  <div class="content">


    <!--ページのメイン部分-->
    <article>

      <h2>Getting Started</h2>
      
      <section>
        <ul>
          <h3><b>本ページは，オープントラック・シチュエーショントラック共通です．</b></h3>
        </br>
          <li>本コンペの参加者は，インスタントメッセージシステム<a href="https://telegram.org/">Telegram</a>で動作するボットを作成していただきます．
          <li>Telegram は，Python，Java，Rubyなど，様々な言語のボット作成用ライブラリがGitHubで公開されており，これらを使って開発いただけます．
          <li>基本的には，お手持ちの対話システムの入出力をTelegram 対応にしていただければOKですが，システム仕様（オープン/シチュエーショントラックそれぞれのページを参照）に記載されている要件を満たす必要があります．
        </ul>
      </section>


      <h2>ボット作成について</h2>
      
      <section>
        <ul>
          <h3><b>Telegramボットの登録方法</b></h3>
        
          <li> 1. Telegramでユーザ名 @BotFather を検索し，+Joinでフレンドに追加</li><br/>
          <li> 2. @BotFatherに /newbot と送信
            <img src="images/newbot.png" width="100%" height="100%"></li><br/>
          <li> 3. BotFatherの「How are we going to call it? Please choose a name for your bot.」に対して，ボット名を入力
          <li> 　※任意の文字列が使用できますが，本コンペで使用するボットは，半角英数字のみ使用してください．
            <img src="images/botname.png" width="100%" height="100%"></li><br/>
          <li> 4. BotFatherの「Now let's choose a username for your bot. It must end in `bot`. Like this, for example: TetrisBot or tetris_bot.」に対して，ボットのusernameを入力
          <li> 　※半角英数字のみ使用可で，最後は'bot'で終わる名前にする．（例：TetrisBot や tetris_bot）
          <li> 　※エントリフォームに入力した「Telegram ボットのusername」と同じにする．
          <li> 　※他に同じusernameのボットがある場合は登録できない．
            <img src="images/username.png" width="100%" height="100%"></li><br/>
          <li> 5. アクセストークンが発行される．プログラム上でこのアクセストークンを指定する必要がある．
          <li> 　※同一の tokenを用いて複数の対話サーバを起動した場合，正しく動かなくなりますのでご注意ください．
            <img src="images/token.png" width="100%" height="100%">
        </ul>
      </section>

      <section>
        <ol>
        <h3><b>ボットの実装例</b></h3>
        
          <li>pythonライブラリを使用したボットの実装例（<a href="samplebot9.py"><font color="red">samplebot9.py</font></a>）で，現在の対話のログからランダムに選択された発話を返すボットです．</li>
          <li>このボットは<a href="system.html"><font color="red">システム仕様</font></a>の要件を満たしていますので，reply関数を書き換えていただくと，独自のボットが作成できます．</li>
          <br/>
          <li>▼<a href="samplebot9.py">samplebot9.py</a>
        </ol>

        <pre class="prettyprint linenums lang-py">
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from telegram.ext import Updater, CommandHandler, MessageHandler, Filters
import time
import random

# アクセストークン
TOKEN = ""

# 1対話の長さ(ユーザの発話回数)．ここは固定とする
DIALOGUE_LENGTH = 15

"""現在の対話のログからランダムに発話を選択し，送信するボット"""

# 対話履歴を受け取り，応答を返す．
# ここを各自書き換えれば自分のシステムができる
# このサンプルでは対話履歴の中からランダムで選択し，それを応答とする．
def reply(context):
    return random.choice(context)


class SampleBot:
    def __init__(self):
        self.user_context = {}

    def start(self, bot, update):
        # 対話ログと発話回数を初期化
        self.user_context[update.message.from_user.id] = {"context": [], "count": 0}

        # システムからの最初の発話
        # 以下の発話に限定しません．任意の発話を返してください
        update.message.reply_text('こんにちは。対話を始めましょう。')


    def message(self, bot, update):
        if update.message.from_user.id not in self.user_context:
            self.user_context[update.message.from_user.id] = {"context": [], "count": 0}

        # ユーザ発話の回数を更新
        self.user_context[update.message.from_user.id]["count"] += 1

        # ユーザ発話をcontextに追加
        self.user_context[update.message.from_user.id]["context"].append(update.message.text)

        # replyメソッドによりcontextから発話を生成
        send_message = reply(self.user_context[update.message.from_user.id]["context"])

        # 送信する発話をcontextに追加
        self.user_context[update.message.from_user.id]["context"].append(send_message)

        # 発話を送信
        update.message.reply_text(send_message)

        if self.user_context[update.message.from_user.id]["count"] >= DIALOGUE_LENGTH:
            # 対話IDは unixtime:user_id:bot_username
            unique_id = str(int(time.mktime(update.message["date"].timetuple()))) + u":" + str(update.message.from_user.id) + u":" + bot.username

            update.message.reply_text(u"_FINISHED_:" + unique_id)
            update.message.reply_text(u"対話終了です．エクスポートした「messages.html」ファイルを，フォームからアップロードしてください．")


    def run(self):
        updater = Updater(TOKEN)

        dp = updater.dispatcher

        dp.add_handler(CommandHandler("start", self.start))

        dp.add_handler(MessageHandler(Filters.text, self.message))

        updater.start_polling()

        updater.idle()


if __name__ == '__main__':
    mybot = SampleBot()
    mybot.run()</pre>


        <br/>
        <ol>
        <h3><b>samplebot9.py の使用方法</b></h3>
        
          <li>1. pythonライブラリをインストールする．<br/>
            　<code>$ pip install python-telegram-bot --upgrade</code>
          </li>
          <li>2. 9行目のTOKENを，Telegramボット登録で発行されたアクセストークンに変更する．<br/>
          <li>3. <code>$ python samplebot9.py </code>で起動<br/>
            　※同一の tokenを用いて複数の対話サーバを起動した場合，正しく動かなくなりますのでご注意ください．
          </li>
          <li>4. Telegramボット上で対話を行う．</li><br/>
            <img src="images/example.png" width="100%" height="100%">
        </ol>

      </section>

      <h2>参考</h2>
      
      <section>
        <ul>
          <h3><b>Telegram</b></h3>
          <li> Telegramボットを登録する方法については<a href="https://telegram-creators.bacronym.net/wiki/bot-entry/">こちら</a></li>

          <br/>

          <h3><b>Pythonライブラリ</b></h3>
          <li> ライブラリ（Github）は<a href="https://github.com/python-telegram-bot/python-telegram-bot">こちら</a>
          <li> <code>$ pip install python-telegram-bot --upgrade</code>でライブラリがインストール可能．
          <br/>
          <li>オウム返しボットのサンプルは<a href="https://github.com/python-telegram-bot/python-telegram-bot/blob/master/examples/echobot2.py">こちら</a></br>
          　55行目のTOKENを発行されたトークンに変更し，<code>$ python echobot2.py </code>で起動</li>

          <br/>

          <h3><b>Javaライブラリ</b></h3>
          <li> ライブラリ（Github）は<a href="https://github.com/rubenlagus/TelegramBots">こちら</a>
          <br/>
          <li>オウム返しボットの作り方は<a href="https://monsterdeveloper.gitbooks.io/writing-telegram-bots-on-java/content/chapter1.html">こちら</a>
        </ul>
      </section>


    </article>

    <!-- / .content -->
  </div>
  <!-- / .wrapper -->
</div>

<!--javascript設定-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script> <!--googleのCDN（ネットワーク経由でコンテンツを提供するサービス）よりjqueryをロード-->
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script> <!--エフェクト効果-->
<script src="js/vertical-responsive-menu.min.js" ></script> <!--レスポンシブメニュー-->
<script src="js/twilight.js"></script> <!--スライドショー-->
<script type="text/javascript">
$(document).ready(function() {
    $('.twilight-show').twilight();
});
setTimeout(function() {
    $(".arrow-right").click();
    setTimeout(arguments.callee, 5000);
}, 3000);
</script>
<script src="js/scrolltopcontrol.js"></script> <!--スクロールしながらページのトップに戻る-->

<script src="js/prettify.js"></script>
<script src="js/lang-css.js"></script>
<!-- prettyPrint()関数を実行するため追加↓ -->
<!-- <script>prettyPrint();</script> -->

</body>
</html>
